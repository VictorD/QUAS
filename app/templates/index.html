<html>
<head>
 <meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">
<script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.js"></script>
<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js"></script>

<title>QUAS - Your LTU knowledge database !</title>
</head>
<body id="main">
<div class="navbar navbar-inverse">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="#">QUAS</a>
		</div>
		<div class="navbar-collapse collapse">
			<form class="navbar-form navbar-right">
				<button type="submit" class="btn btn-primary">Login</button>
			</form>
		</div>
	</div>
</div>

<div class="container">
	<div class="row text-center">
		<img src="static/logo.png" width="359px" height="220px"/>
	</div>
	<div class="row">
		<div class="col-lg-10 col-lg-offset-1">
				
			<form id="search" class="form-horizontal" role="form" method="POST" target="#">
				<div class="form-group">
						<div class="col-lg-7 col-lg-offset-2 ">
							<input id="search-bar" type="text" class="form-control"/>
						</div>
						<div class="col-lg-1">
							<input id="submit-button" type="submit" value="Search" class="btn btn-primary"/>
						</div>
				</div>
			</form>
		</div>
	</div>
</div>
<div class="container">
	<div class="row">
		<h3>Filter Questions: </h3>

		<div class="btn-group">
			<button type="button" class="btn btn-default">Recent</button>
			<button type="button" class="btn btn-default">Unanswered</button>
			<button type="button" class="btn btn-default">Top voted</button>
			<button type="button" class="btn btn-default">Subscribed</button>
		</div>
	</div>
	<div class="row">
		<table class="table">
		<thead>
			<th>Title</th>
			<th>Description</th>
			<th>Answers</th>
			<th>Score</th>
			<th>Tags</th>
		</thead>
		<tbody>
		<!-- ko foreach: questions -->
		<tr class="question">
			<td><a href="#" data-bind="text: title"></a></td>
			<td data-bind="text: body"></td>
			<td class="text-center"><span class="badge">42</span></td>
			<td class="text-center"><span class="badge">13</span></td>
			<td>#tag1 #tag2</td>
		</tr>
		<!-- /ko -->
		</tbody>
		</table>
	</div>
</div>

<div id="footer">
</div>
</div>

<script type="text/javascript">
function QViewModel(){
	
	this.qURI = 'http://130.240.5.168:5000/questions/';
	window.questions = ko.observableArray();

	
	this.ajax = function(uri, method, data){
		var request = {
			url: uri,
			type: method,
			contentType: "application/json",
			accepts: "application/json",
			cache: false,
			dataType: 'json',
			data: JSON.stringify(data)
		};
		return $.ajax(request);
	}
	
	
	
	// data.questions.length
	this.ajax(this.qURI, 'GET').done(function(data) {
		console.log("We are in ajax();");
		
		
		var ql = data.QuestionList;
		
		for (var i = 0; i < ql.length; i++) {
			console.log("In the loop #"+i);
			window.questions.push({
				uri: ko.observable(ql[i].uri),
				title: ko.observable(ql[i].title),
				body: ko.observable(ql[i].body),
				timestamp: ko.observable(ql[i].timestamp),
				done: ko.observable(ql[i].done)
			});
		} 
	});

}


// Need "add" ko-tag in html
ko.applyBindings(new QViewModel());
</script>
</body>
</html>
